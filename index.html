<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LinguaVox | Universal Translator</title>

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
--primary:#00cec9;
--bg:#1e272e;
--card:#2f3640;
--text:#dcdde1;
--input:#1e272e;
}

*{box-sizing:border-box}

body{
margin:0;
font-family:'Outfit',sans-serif;
background:var(--bg);
color:var(--text);
display:flex;
justify-content:center;
align-items:center;
min-height:100vh;
}

.app{
width:92%;
max-width:520px;
background:var(--card);
border-radius:20px;
padding:25px;
box-shadow:0 20px 50px rgba(0,0,0,.4);
}

h1{
margin:0 0 10px;
text-align:center;
}

textarea{
width:100%;
height:110px;
background:var(--input);
border:2px solid #000;
border-radius:14px;
color:var(--text);
padding:14px;
font-size:16px;
resize:none;
}

select,button{
width:100%;
margin-top:12px;
padding:14px;
border-radius:12px;
border:none;
font-size:16px;
font-family:'Outfit',sans-serif;
}

select{
background:var(--input);
color:var(--text);
border:2px solid #000;
}

button{
background:linear-gradient(135deg,#00cec9,#0984e3);
color:#fff;
font-weight:700;
cursor:pointer;
}

button:active{transform:scale(.98)}

.output{
margin-top:15px;
padding:15px;
border-radius:12px;
background:#00000030;
color:var(--primary);
font-size:1.1rem;
display:none;
}

.speed{
margin-top:10px;
font-size:.85rem;
}

input[type=range]{
width:100%;
accent-color:var(--primary);
}
</style>
</head>

<body>

<div class="app">
<h1>LinguaVox ğŸŒ</h1>

<textarea id="inputText" placeholder="Type text in English..."></textarea>

<select id="language">
<option value="hi-IN">ğŸ‡®ğŸ‡³ Hindi</option>
<option value="mr-IN">ğŸ‡®ğŸ‡³ Marathi</option>
<option value="ta-IN">ğŸ‡®ğŸ‡³ Tamil</option>
<option value="te-IN">ğŸ‡®ğŸ‡³ Telugu</option>
<option value="bn-IN">ğŸ‡®ğŸ‡³ Bengali</option>
<option value="ur-PK">ğŸ‡µğŸ‡° Urdu</option>

<option value="ja-JP">ğŸ‡¯ğŸ‡µ Japanese</option>
<option value="ko-KR">ğŸ‡°ğŸ‡· Korean</option>
<option value="zh-CN">ğŸ‡¨ğŸ‡³ Chinese</option>

<option value="fr-FR">ğŸ‡«ğŸ‡· French</option>
<option value="es-ES">ğŸ‡ªğŸ‡¸ Spanish</option>
<option value="de-DE">ğŸ‡©ğŸ‡ª German</option>
<option value="it-IT">ğŸ‡®ğŸ‡¹ Italian</option>
<option value="pt-PT">ğŸ‡µğŸ‡¹ Portuguese</option>
<option value="ru-RU">ğŸ‡·ğŸ‡º Russian</option>
<option value="tr-TR">ğŸ‡¹ğŸ‡· Turkish</option>

<option value="ar-SA">ğŸ‡¸ğŸ‡¦ Arabic</option>
</select>

<div class="speed">
Speech Speed
<input type="range" id="speed" min="0.5" max="1.5" step="0.1" value="1">
</div>

<button id="translateBtn">Translate & Speak</button>

<div id="output" class="output"></div>
</div>

<script>
const inputText = document.getElementById("inputText");
const language = document.getElementById("language");
const translateBtn = document.getElementById("translateBtn");
const output = document.getElementById("output");
const speed = document.getElementById("speed");

/* ---------------- TRANSLATION ---------------- */
async function translate(text, target){
  const lang = target.split("-")[0];

  const response = await fetch("https://libretranslate.de/translate",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      q:text,
      source:"en",
      target:lang,
      format:"text"
    })
  });

  const data = await response.json();
  return data.translatedText;
}

/* ---------------- SPEECH ---------------- */
function speak(text, lang){
  speechSynthesis.cancel();

  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = lang;
  utter.rate = speed.value;

  const voices = speechSynthesis.getVoices();

  if(!voices.length){
    setTimeout(()=>speak(text,lang),300);
    return;
  }

  const voice =
    voices.find(v=>v.lang===lang) ||
    voices.find(v=>v.lang.startsWith(lang.split("-")[0]));

  if(voice) utter.voice = voice;

  speechSynthesis.speak(utter);
}

/* ---------------- ACTION ---------------- */
translateBtn.onclick = async ()=>{
  const text = inputText.value.trim();
  if(!text) return alert("Please enter text");

  output.style.display="block";
  output.textContent="Translating...";

  translateBtn.textContent="Processing...";

  try{
    const translated = await translate(text, language.value);
    output.textContent = translated;
    speak(translated, language.value);
  }catch{
    output.textContent="Translation failed. Try again.";
  }

  translateBtn.textContent="Translate & Speak";
};

/* Safari voice preload */
speechSynthesis.onvoiceschanged = () => speechSynthesis.getVoices();
</script>

</body>
</html>
